From ad64f6058c16e3f7511bfe60a3da9306b802304c Mon Sep 17 00:00:00 2001
From: "matteo.lisi" <matteo.lisi@engicam.com>
Date: Tue, 10 Nov 2015 12:00:20 +0100
Subject: [PATCH] fix backlight settings on geam6ul

---
 arch/arm/boot/dts/imx6ul-gea.dts | 28 ++++++++++++++++++++--------
 arch/arm/boot/dts/imx6ul.dtsi    |  4 ++--
 2 files changed, 22 insertions(+), 10 deletions(-)

diff --git a/arch/arm/boot/dts/imx6ul-gea.dts b/arch/arm/boot/dts/imx6ul-gea.dts
index 83cf36c1..7eb4305 100644
--- a/arch/arm/boot/dts/imx6ul-gea.dts
+++ b/arch/arm/boot/dts/imx6ul-gea.dts
@@ -25,9 +25,19 @@
 
 	backlight {
 		compatible = "pwm-backlight";
-		pwms = <&pwm1 0 5000000>;
-		brightness-levels = <0 4 8 16 32 64 128 255>;
-		default-brightness-level = <6>;
+		pwms = <&pwm8 0 100000>;
+		brightness-levels = < 0  1  2  3  4  5  6  7  8  9
+				     10 11 12 13 14 15 16 17 18 19
+	   			     20 21 22 23 24 25 26 27 28 29
+				     30 31 32 33 34 35 36 37 38 39
+				     40 41 42 43 44 45 46 47 48 49
+				     50 51 52 53 54 55 56 57 58 59
+				     60 61 62 63 64 65 66 67 68 69
+				     70 71 72 73 74 75 76 77 78 79
+				     80 81 82 83 84 85 86 87 88 89
+				     90 91 92 93 94 95 96 97 98 99
+				    100>;
+		default-brightness-level = <100>;
 		status = "okay";
 	};
 
@@ -240,12 +250,14 @@
 	};
 };
 
-&pwm1 {
+
+&pwm8 {
 	pinctrl-names = "default";
-	pinctrl-0 = <&pinctrl_pwm1>;
+	pinctrl-0 = <&pinctrl_pwm8>;
 	status = "okay";
 };
 
+
 &pxp {
 	status = "okay";
 };
@@ -376,7 +388,6 @@
 		pinctrl_enet1: enet1grp {
 			fsl,pins = <
 				MX6UL_PAD_ENET1_RX_EN__ENET1_RX_EN	0x1b0b0
-//				MX6UL_PAD_ENET1_RX_ER__ENET1_RX_ER	0x1b0b0
 				MX6UL_PAD_ENET1_RX_DATA0__ENET1_RDATA00	0x1b0b0
 				MX6UL_PAD_ENET1_RX_DATA1__ENET1_RDATA01	0x1b0b0
 				MX6UL_PAD_ENET1_TX_EN__ENET1_TX_EN	0x1b0b0
@@ -468,9 +479,10 @@
 			>;
 		};
 
-		pinctrl_pwm1: pwm1grp {
+
+		pinctrl_pwm8: pwm8grp {
 			fsl,pins = <
-				MX6UL_PAD_GPIO1_IO08__PWM1_OUT   0x110b0
+				MX6UL_PAD_ENET1_RX_ER__PWM8_OUT   0x110b0
 			>;
 		};
 
diff --git a/arch/arm/boot/dts/imx6ul.dtsi b/arch/arm/boot/dts/imx6ul.dtsi
index 72fb004..d46408e 100644
--- a/arch/arm/boot/dts/imx6ul.dtsi
+++ b/arch/arm/boot/dts/imx6ul.dtsi
@@ -778,8 +778,8 @@
 				compatible = "fsl,imx6ul-pwm", "fsl,imx27-pwm";
 				reg = <0x020fc000 0x4000>;
 				interrupts = <GIC_SPI 117 IRQ_TYPE_LEVEL_HIGH>;
-				clocks = <&clks IMX6UL_CLK_DUMMY>,
-					 <&clks IMX6UL_CLK_DUMMY>;
+				clocks = <&clks IMX6UL_CLK_PWM8>,
+					 <&clks IMX6UL_CLK_PWM8>;
 				clock-names = "ipg", "per";
 				#pwm-cells = <2>;
 			};
-- 
1.9.1

